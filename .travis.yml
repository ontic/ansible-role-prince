# Copyright (c) Ontic. (http://www.ontic.com.au). All rights reserved.
# See the COPYING file bundled with this package for license details.

---

services: 'docker'

env:
  - distribution: 'centos'
    version: '7'
  - distribution: 'debian'
    version: '9'
  - distribution: 'ubuntu'
    version: '16.04'

before_install:
  - 'export container_id=$(date +%s)'
  - 'export cleanup=false'
  - 'wget -O ${PWD}/tests/test.sh https://raw.githubusercontent.com/ontic/ansible-role-test/master/test.sh'
  - 'chmod +x ${PWD}/tests/test.sh'
  - '${PWD}/tests/test.sh build'

script:
  - '${PWD}/tests/test.sh test'
  - 'docker exec --tty "$(cat ${container_id})" env TERM=xterm which prince'
  - 'docker exec --tty ${container_id} env TERM=xterm prince --version'

notifications:
  webhooks: 'https://galaxy.ansible.com/api/v1/notifications/'